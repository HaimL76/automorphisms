\documentclass[12pt]{article}
\makeatletter
\newcommand*{\rom}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother
\usepackage{amsfonts, amssymb}
\usepackage{mathrsfs, mathdots} 
\usepackage{amsmath}
\usepackage{float}
\usepackage{amsthm}
\usepackage{tikz-cd}
\usepackage{xcolor}
\usepackage{xparse}
\usepackage{setspace}
\usepackage{xfrac}
\usepackage{yfonts}

\newtheorem{theorem}{Theorem}[subsection]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notations}[theorem]{Notations}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

\ExplSyntaxOn
\NewDocumentCommand{\cycle}{ O{\;} m }
 {
  (
  \alec_cycle:nn { #1 } { #2 }
  )
 }

\seq_new:N \l_alec_cycle_seq
\cs_new_protected:Npn \alec_cycle:nn #1 #2
 {
  \seq_set_split:Nnn \l_alec_cycle_seq { , } { #2 }
  \seq_use:Nn \l_alec_cycle_seq { #1 }
 }
\ExplSyntaxOff
\usepackage{arydshln}

\setlength{\dashlinedash}{1.2pt}
\setlength{\dashlinegap}{1.5pt}
\setlength{\arrayrulewidth}{0.2pt}
\title{The pro-isomorphic zeta-functions of some nilpotent Lie algebras over integer rings}
\author{Haim Lavi}
\date{\today}
\begin{document}
\maketitle
\begin{abstract}
Let $G$ be any group. For any natural number $n\in\mathbb{N}$, let $a_n$ be the number of subgroups $H\leq G$, such that $[G:H]=n$. Assume $G$ is finitely-generated, then $a_n<\infty$, and we can define a Dirichlet series of the form $\zeta_G(s):=\sum_{i=1}^\infty a_n n^{-s}$, where $s\in\mathbb{C}$. Assume, in addition, that $G$ is also nilpotent and torsion-free, then this function has some properties of the Riemann $\zeta$-function, such as the Euler decomposition of $\zeta$ into a product of local factors indexed by primes. A version of this $\zeta$-function counts pro-isomorphic subgroups, and an analogous function may be defined for appropriate Lie rings. We study here the pro-isomorphic $\zeta$-functions for a family of nilpotent Lie rings of unbounded nilpotency class. We shall compute the automorphism groups of these Lie rings explicitly, prove uniformity of the local factors of the pro-isomorphic $\zeta$-functions, and aim to determine them explicitly.
\end{abstract}
\section{Scientific Background}
\subsection{Introduction}
We start our discussion with the following proposition, which stands at the very foundation of our subject.
\begin{proposition} \label{prop:finite.number.subgroups}
Let $G$ be any finitely generated group, and let $n\in\mathbb{N}$ any natural number. Then there is a finite number of subgroups $H\leq G$, such that $[G:H]=n$
\end{proposition}
\begin{proof}
Let $H\leq G$ be a subgroup, such that $[G:H]=n$, and let $\sfrac{G}{H}:=\{g_1H,g_2H,\dots,g_nH\}$ be the set containing all left-cosets of $H$ in $G$. We may consider the action of $G$ by left multiplication on $\sfrac{G}{H}$: for all $g\in G$, and for all left-cosets $g_iH\in\sfrac{G}{H}$, we have that $g(g_iH):=(gg_i)H=g_jH$, where $g_jH\in\sfrac{G}{H}$ is some left-coset. This means that $g$ maps every index $i\in[n]$ to some index $j\in[n]$, which means that $g$ operates as a permutation on $[n]$. Therefore, there exists a homomorphism $f:G\rightarrow\mathcal{S}_n$, from $G$ to the symmetric group of order $n$. Let $1\leq k\leq n$ be the index for which $g_kH=H$. For all $g\in G$, $g\in H$ if and only if $gH=H$, which means that $(gg_k)H=g(g_kH)=gH=H=g_kH$, which means that $f(g)(k)=k$, in words, $k$ is fixed by the image $f(g)$. This means that $H=\{g\in G : f(g)(k)=k\}$, so $H$ may be recovered from the homomorphism $f$, which clearly shows that the number of subgroups $H\leq G$ of index $n$ is less or equal to the number of maps $f : G
\rightarrow\mathcal{S}_n$. We assumed that $G$ is finitely-generated, and $\mathcal{S}_n$ is obviously finite. We know that group homomorphisms are uniquely determined by the maps of their generators. Therefore, there are finitely many maps from a finite set of generators to a finite group, which clearly shows that the number of subgroups $H\leq G$ of index $n$ is necessarily finite.
\end{proof}
This proposition gives rise to an entire subject in group theory, called \textbf{subgroup growth}. We denote by $a_n(G)$ the number of subgroups of $G$ of index $n$, and look at the sequence $\{a_n(G)\}$. The subject of subgroup growth aims to relate the properties of this sequence to the algebraic structure of $G$. For instance, Lubotzky, Mann and Segal showed\cite{LubotzkyMannSegal} that $a_n(G)$ grows polynomially if and only if $G$ is virtually solvable of finite rank. That is, $G$ has a finite-index solvable subgroup, and all finitely-generated subgroups may be generated by a bounded number of generators. This research concentrates on the growth of \textbf{pro-isomorphic} subgroups, which we now define.
\begin{definition}
\label{def:profinite.closure}
Let $G$ be any group, and let $\mathcal{N}:=\{N_i\trianglelefteq G\}_{i\in I}$ be the set of all normal subgroups of $G$. We define a partial order on $\mathcal{N}$ by reverse inclusion, that is for every two indices $i,j$ we say that $i\leq j$ if and only if $N_j\subseteq N_i$, hence for every $i\leq j$ there exists a natural projection map $\pi_{ji}:\sfrac{G}{N_
j}\rightarrow\sfrac{G}{N_i}$. The inverse limit \[\widehat{G}=\underset{\leftarrow}{lim}\{\sfrac{G}{N_k}\}_{k\in I}:=\{(h_k)_{k\in I}\in\prod_{k\in I}\sfrac{G}{N_k} : \pi_{ji}(h_j)=h_i,\forall i\leq j\}\] is called the \textbf{profinite closure} of $G$.
\end{definition}
\begin{definition}
\label{def:pro.isomorphic}
Let $G$ be any group. A subgroup $H\leq G$ is called \textbf{pro-isomorphic} if $\widehat{H}\cong\widehat{G}$.
\end{definition}
\begin{definition}
\label{def:zeta.pro.isomorphic}
Let $G$ be any group, and let \[\hat{a_n}(G):=\#\{H\leq G : \widehat{H}\cong\widehat{G}, [G:H]=n\}\] be the number of pro-isomorphic subgroups of $G$ of index $n$. Assume that $\hat{a_n}(G)<\infty$ for all $n$. The \textbf{pro-isomorphic $\zeta$-function} of $G$ is defined by $\hat{\zeta_G}(s):=\sum_{n=1}^{\infty}\hat{a_n}(G)n^{-s}$ for $s\in\mathbb{C}$.
\end{definition}
If our $\zeta$-function, which is a special case of the Dirichlet series, has some properties of convergence, on some subset of $\mathbb{C}$, one may reconstruct its coefficients, $\hat{a_n}(G)$, which, in our case, are the number of subgroups of our interest, using the \textbf{Perron's forumla}, which is an implementation of a \textbf{reverse Mellin transform}, as discussed, for example, in \cite{MontgomeryVaughan}. This method, including the specific properties of convergence required for the reconstruction, is out of the scope of our research, and therefore will not be further discussed, at this stage.\par
It is known that if $\hat{a_n}(G)$ grows polynomially, then $\hat{\zeta_G}(s)$ converges on some right half-plane of $\mathbb{C}$. For instance, we take the group $G=(\mathbb{Z},+)$. The group $\mathbb{Z}$ is an abelian group, and every subgroup is of the form $H=n\mathbb{Z}=\langle n\rangle$, for some $n\in\mathbb{N}$, which means that $H\cong \mathbb{Z}$, as both are infinite cyclic groups, and so, $\widehat{H}\cong\widehat{\mathbb{Z}}$. Since we have only one subgroup of index $n$, for every $n\in\mathbb{N}$, then $a_n(\mathbb{Z})=\hat{a_n}(\mathbb{Z})=1$. Thus, its pro-isomorphic $\zeta$-function is $\hat{\zeta_{\mathbb{Z}}}=\sum_{i=1}^{\infty}n^{-s}=\zeta(s)$, the Riemann $\zeta$-function, which is known to converge for $Re(s)>1$.\par
After establishing the basic definitions, we observe a fact that is a major motivation for this research, which says that the Riemann $\zeta$-function decomposes into an infinite product of local zeta-functions, that is, $\zeta(s)=\prod_p\zeta_p(s)=\prod_p\sum_{k=0}^\infty p^{-ks}=\prod_p\frac{1}{1-p^{-s}}$, where the product runs over all the prime numbers. Following this fact, regarding the Riemann $\zeta$-function, we observe that for any finitely-generated, nilpotent and torsion-free group $G$, we have the same decomposition as above for the pro-isomorphic $\zeta$-function: $\hat{\zeta_G}(s)=\prod_p\hat{\zeta_{G,p}}(s)$, where $\hat{\zeta_{G,p}}(s):=\sum_{k=0}^\infty \hat{a_{p^k}}(G)p^{-ks}$. The general construction of $\zeta$-functions, as well as their Euler decomposition to local zeta-functions, for the study of subgroup growth, were well established by Grunewald, Segal and Smith, in \cite{GrunewaldSegalSmith}. We hereby bring several basic definitions of group nilpotency, which are very important for this research.
\begin{definition}
\label{def.lower.central.series}
Let $G$ be any group. The \textbf{lower central series} of $G$ is a sequence of subgroups of $G$ defined by the recursive rule $G_n:=[G,G_{n-1}]$, for every $n\in\mathbb{N}$, where $G_0:=G$.  We recall that $[G,G_n]\leq G$ is the subgroup generated by the collection of commutators $\{gg_ng^{-1}g_n^{-1} : g\in G,g_n\in G_n\}$.
\end{definition}
\begin{definition}
\label{def.nilpotency.class}
Let $G$ be any group. The \textbf{nilpotency class} of $G$ is $min\{n\in\mathbb{N} : G_n=[G,G_{n-1}]=\{e\}\}$, in words, the smallest natural number, such that the subgroup of commutators of the form $[G,G_n]$ is the trivial group. We can extend this definition, and say that the trivial group nilpotency class is $0$.
\end{definition}
\begin{definition}
\label{def.nilpotent.group}
Let $G$ be a group. If $G$ is of finite nilpotency class, then $G$ is said to be a \textbf{nilpotent} group.
\end{definition}
\subsection{Linearization}
We want to transfer the ideas from the above discussion about groups to a linear context, where we can use tools from linear algebra.
Hence, for finitely-generated torsion-free nilpotent groups $G$, we associate nilpotent Lie algebras over $\mathbb{Z}$. This, in general, is called the \textbf{Maltsev correspondance}. 
If $L$ is a $\mathbb{Z}$-Lie algebra, namely a free $\mathbb{Z}$-module of a finite rank with a Lie brackets operation, then consider the (finite) number $\hat{a_n}(L)$ of subalgebras $M\leq L$, such that $M\otimes\mathbb{Z}_p\cong L\otimes\mathbb{Z}_p$ for all primes $p$. The Dirichlet series $\hat{\zeta_L}(s):=\sum_{n=1}^{\infty}\hat{a_n}(L)n^{-s}$, is called the \textbf{pro-isomorphic zeta-function} of $L$. By the Maltsev correspondence, to every finitely-generated, nilpotent, torsion-free group $G$, one may associate a Lie algebra $L(G)$, such that $\hat{\zeta_{G,p}}(s)=\hat{\zeta_{L,p}}(s)$, for but finitely many primes $p$. If $G$ has nilpotency class $2$, one may obtain the equality for all primes. Let $n\in\mathbb{N}$, and let $L_n$ be a $\mathbb{Z}$-Lie algebra, and fix a $\mathbb{Z}$-basis $\mathcal{B}=\{b_1,\dots,b_r\}$, where $r$=rank$L_n$ depends on $n$. Let $\mathcal{L}_{n,p}=L_n\otimes_{\mathbb{Z}}\mathbb{Q}_p$, for any $p$. This is a $\mathbb{Q}_p$-Lie algebra, and our choice of basis allows us to identify the automorphism group $G_n(\mathbb{Q}_p)=Aut_{\mathbb{Q}_p}(\mathcal{L}_{n,p})$ with a subgroup of $GL_r(\mathbb{Q}_p)$. Note that $\mathcal{L}_{n,p}$ contains a $\mathbb{Z}_p$-lattice, $L_{n,p}=L_n\otimes_{\mathbb{Z}}\mathbb{Z}_p$. If $\varphi\in G_n(\mathbb{Q}_p)$, then $\varphi(L_{n,p})=L_{n,p}$ if and only if $\varphi\in G_n(\mathbb{Z}_p)=G_n(\mathbb{Q}_p)\cap GL_r(\mathbb{Z}_p)$. Here $GL_r(\mathbb{Z}_p)$ is the group of $r\times r$ matrices which are invertible over $\mathbb{Z}_p$. Similarly, $\varphi(L_{n,p})\subseteq L_{n,p}$ if and only if $\varphi\in G^+_n(\mathbb{Q}_p):=G_n(\mathbb{Q}_p)\cap \mathcal{M}_r(\mathbb{Z}_p)$, where $\mathcal{M}_r(\mathbb{Z}_p)$ is the collection of $r\times r$ matrices with entries in $\mathbb{Z}_p$. Note that $G^+_n(\mathbb{Q}_p)$ is a monoid, not a group.\par
Denote by $G_n(\mathbb{Z}_p)g$, where $g\in G^+_n(\mathbb{Q}_p)$, a right-coset of $G_n(\mathbb{Z}_p)$, one checks that the monoid $G^+_n(\mathbb{Q}_p)$ is a disjoint union of right-cosets of $G_n(\mathbb{Z}_p)$.\par
The discussion above reveals the construction we base our research upon.
We observe that there is a bijection between the set $G_n(\mathbb{Z}_p)\backslash G^+_n(\mathbb{Q}_p)$ of right-cosets and $\{M\leq L_{n,p} : M\cong L_{n,p}\}$ the set of $L_{n,p}$-subalgebras which are isomorphic to $L_{n,p}$ itself. This bijection takes $G_n(\mathbb{Z}_p)g$ to $M=\varphi(L_{n,p})$. For any $\varphi\in G_n(\mathbb{Z}_p)g$, this is well-defined. One checks that for every $\psi\in G_n(\mathbb{Z}_p)g$, we have that $\psi(L_{n,p})=\varphi(L_{n,p})=M$.
We end this part, as a preparation for the final part of this technical background review, with the following result, which states that for each right-coset, $G_n(\mathbb{Z}_p)g$, if $M=\varphi(L_{n,p})$, where $\varphi\in G_n(\mathbb{Z}_p)g$, then $[L_{n,p}:M]=|\det\varphi|_p^{-1}$, and therefore,\par $\hat{\zeta_{L,p}}(s)=\underset{\overset{\scriptscriptstyle M\leq L_{n,p}}{\scriptscriptstyle M\cong L_{n,p}}}{\sum}[L_{n,p}:M]^{-s}=\underset{\scriptscriptstyle G_n(\mathbb{Z}_p)\varphi\in G_n(\mathbb{Z}_p)\backslash G^+_n(\mathbb{Q}_p)}{\sum}|\det\varphi|_p^s$.
Last for this section, we shall define the central lower series for Lie algebras, which will be our main working tool, in the research of the automorphism groups.
\begin{definition}
Let $L$ be a Lie algebra, then the $\textbf{lower central series}$ of $L$ is defined by $\gamma_k L:=[L,\gamma_{k-1}L]$ where $k\in\mathbb{N}$, and $\gamma_1 L:=L$, same as defined for groups in \ref{def.lower.central.series}. A Lie algebra is said to be \textbf{nilpotent}, if $\gamma_k L=\{0\}$, for some finite $k$, also as defined above for groups in \ref{def.nilpotent.group}. When the algebra is clear from the context, we may omit the notation of the algebra in $\gamma_k L$, only to stay with the gamma notation $\gamma_k$. Sometimes, we will also use the gamma notation for nilpotnecy classes of groups.
\end{definition}
\subsection{$p$-adic Integration}
In this final part of the technical background review, we finally get to the motivation for all the construction we have presented in the first parts. We now define a very central object for our research. We shall assume, without proof, the existence of such an object, under the prerequisites of the definition.
\begin{definition}
\label{def.right.haar.measure}
Let $\Gamma$ be a locally compact topological group, i.e., for all $\gamma\in\Gamma$, there is an open neighborhood of $\gamma\in U_{\gamma}$, and a compact subset $K_{\gamma}$, such that $U_{\gamma}\subset K_{\gamma}$. Then there is a measure $\mu$, with the following property: for any measurable subset, $U\subseteq\Gamma$, and any $\gamma\in\Gamma$, $\mu(U\gamma)=\mu(U)$, where $U\gamma:=\{u\gamma : u\in U\}$. Such a measure $\mu$ is called a \textbf{right Haar measure}, and is unique up to multiplication by a non-zero constant.
\end{definition}
Equipped with the right Haar measure, we can finally make use of the construction from above. We start by claiming, without proof, that for every prime number $p$, the group $G_n(\mathbb{Q}_p)$ is a locally compact topological group. We also claim that the right Haar measure has the property that $\mu(G_n(\mathbb{Z}_p))=1$. The measure of all the right-cosets of $G_n(\mathbb{Z}_p)$ equals to the measure of $G_n(\mathbb{Z}_p)$ itself, i.e., for every $g\in G^+_n(\mathbb{Q}_p)$, we have that $\mu(G_n(\mathbb{Z}_p)g)=\mu(G_n(\mathbb{Z}_p))=1$.
With this observation, we go directly to the calculation of the $p$-adic norm of the determinant of every $L_{n,p}$-automorphism, as a $p$-adic integral over our measure space.
First, we observe that given any $L_{n,p}$-automorphism in some right-coset, $\varphi\in G_n(\mathbb{Z}_p)\varphi$, we have that $|\det\varphi|_p^s=\displaystyle\int_{G_n(\mathbb{Z}_p)\varphi}|\det\varphi|_p^sd\mu$, because $\mu(G_n(\mathbb{Z}_p)\varphi)=1$, and $|\det\varphi|_p^{-1}$ is fixed on $G_n(\mathbb{Z}_p)\varphi$.\par
Going back to our desired function, we observe that\par $\hat{\zeta_{L,p}}(s)=\underset{\scriptscriptstyle G_n(\mathbb{Z}_p)\varphi\in G_n(\mathbb{Z}_p)\backslash G^+_n(\mathbb{Q}_p)}{\sum}|\det\varphi|_p^s=\underset{\scriptscriptstyle G_n(\mathbb{Z}_p)\varphi\in G_n(\mathbb{Z}_p)\backslash G^+_n(\mathbb{Q}_p)}{\sum}\displaystyle\int_{G_n(\mathbb{Z}_p)\varphi}|\det\varphi|_p^sd\mu=\displaystyle\int_{G^+_n(\mathbb{Z}_p)}|\det\varphi|_p^sd\mu$.\par 
This calculation of the local $\zeta_p$-function as a $p$-adic integral was established by the work of du Sautoy and Lubotzky, in \cite{DuSautoyLubotzky}.
This integral is the main object we shall study, in this research.
We end this part, of the technical background review, by a definition and a theorem, which stand in the center of our research goals.
\begin{definition}
Let $L$ be a $\mathbb{Z}$-Lie algebra, and let $s\in\mathbb{C}$. Then $\hat{\zeta_L}(s)$ is called \textbf{uniform}, if there exists a rational function in two variables $W\in\mathbb{Q}(X,Y)$ such that for every prime number $p$, the local function $\zeta_{L,p}(s)=W(p,p^{-s})$, which means that $\zeta_{L,p}(s)$ has exactly the same form for all primes, since its value depends only on $p$ and $p^{-s}$.
\end{definition}
\begin{theorem}
\label{thm.rational.function}
Let $p$ be a prime number, and let $s\in\mathbb{C}$, then $\hat{\zeta_{L,p}}(s)$ is rational, i.e. there is a rational function in one variable $W_p\in\mathbb{Q}(X)$ such that $\zeta_{L,p}(s)=W_p(p^{-s})$.
\end{theorem}
The uniformity is also established in the work of Grunewald, Segal and Smith, see \cite{GrunewaldSegalSmith}.
Proving the uniformity of the pro-isomorphic zeta-functions of the algebras we are studying is one of the main goals of our research.
\section{Research Goals and Methodology}
\subsection{The unipotent group $\mathcal{U}_n$}
We start by defining the families of groups and corresponding Lie algebras that will be considered in this project.
\begin{definition}
\label{def.unipotent.matrix}
Let $\mathcal{R}$ be a commutative ring. Then $\mathcal{U}_n(\mathcal{R})\leq GL_n(\mathcal{R})$ is the subgroup of upper unitriangular matrices over $\mathcal{R}$, i.e. $\mathcal{U}_n(\mathcal{R})=\Bigg\{
\begin{pmatrix}
1 & a_{12} &\\
  & \ddots & \ddots\\
  & & 1\\
\end{pmatrix}\Bigg\}$.
\end{definition}
 One easily checks that $\mathcal{U}_n(\mathcal{R})$ is a special case of a \textbf{unipotent} group.
Looking into the structure of $\mathcal{U}_n(\mathcal{R})$, we observe that we can find a set of generators, $\mathcal{U}_n(\mathcal{R})$. Denote by $E_{ij}$, where $i<j$, an elementary matrix of the form $\begin{pmatrix}
1 & 0 & \dots & 0\\
  & \ddots & 1 & 0\\
  &  & 1 & 0\\
  & & & 1\\
  \end{pmatrix}\in \mathcal{U}_n(\mathcal{R})$, where, in addition to the main diagonal, only the element in row $i$ and column $j$ is $1$, and all the other elements are $0$. One checks that if $i<j$ and $k<l$, then the commutator is \[
  [E_{ij},E_{kl}]=\begin{cases}
    E_{il}, & j=k\\
    -E_{kj}, & {i=l}\\
    I_n, & \text{otherwise}\\
    \end{cases}
    \]
  In addition, it is easy to observe that $E_{ij}^m=\begin{pmatrix}
1 & 0 & \dots & 0\\
  & \ddots & m & 0\\
  &  & 1 & 0\\
  & & & 1\\
  \end{pmatrix}$, for every $m\in\mathbb{Z}$, by simple induction.
All this means that we can generate $\mathcal{U}_n(\mathcal{R})$ entirely by the set $\mathcal{U}_n:=\{E_{1,2},\dots,E_{n-1,n}\}$. From this, it is also clear that $\mathcal{U}_n(\mathcal{R})$ is nilpotent, of nilpotency class $n$, because the longest chain of commutators in $\mathcal{U}_n(\mathcal{R})$, i.e., chaining all the elements in the set of generators, $\mathcal{U}_n$, by the order of their indices, yields $[E_{1,2},[E_{2,3},[\dots,[E_{n-1,n}]]]]=E_{1,n}$, which means that $\gamma_{n-1}\mathcal{U}_n(\mathcal{R})=\{E_{1,n}\}$, which means that $\gamma_n \mathcal{U}_n(\mathcal{R})=I_n$.\par
This also shows that $\mathcal{U}_n(\mathcal{R})$ is torsion-free if and only if $\mathcal{R}$ itself is torsion-free, as can be readily seen from the fact that $E_{ij}^m$ has an $m$ in row $i$ and column $j$, and $m\neq 0$ if and only if $\mathcal{R}$ is torsion-free, for instance, $\mathcal{R}=\mathbb{Z}$.\par
These facts, regarding $\mathcal{U}_n(\mathbb{Z})$ place it as a group of our interest, for this research, and bring us next to its associated Lie algebra.
\subsection{The Lie algebras $L_{n,p}$}
We start with the elementary matrices $E_{i,j}$ where $i<j$, from above, and define strictly upper triangular matrices of the form $e_{i,j}=E_{i,j}-I_n$, in words, $e_{i,j}$ is obtained by replacing all the $1$ on the main diagonal with $0$. It is readily seen that the standard brackets operation on these matrices is compatible with the commutator on matrices in $\mathcal{U}_n$, i.e., $[e_{i,i+1},e_{j,j+1}]=[E_{i,i+1}-I_n,E_{j,j+1}-I_n]=[E_{i,i+1},E_{j,j+1}]-I_n=e_{i,i+1}e_{j,j+1}-e_{j,j+1}e_{i,i+1}$. Considering now $\mathcal{R}=\mathbb{Z}$, we construct a nilpotent $\mathbb{Z}$-Lie algebra of strictly upper triangular matrices over $\mathbb{Z}$, which we denote by $L_n$, with the standard brackets operation as its Lie brackets. As discussed above, this $\mathbb{Z}$-Lie algebra can be extended to a $\mathbb{Z}_p$-algebra, which we denote by $L_{n,p}$, and then to a $\mathbb{Q}_p$-algebra, which we denote by $\mathcal{L}_{n,p}$.
it is readily seen that the set of matrices of the form $e_{ij}$ where $i<j$, spans the whole $\mathbb{Z}$-Lie algebra $L_n$ and is $\mathbb{Z}$-linearly independent. Therefore, it forms the standard basis for $L_n$ as a free module over $\mathbb{Z}$, $\mathcal{B}_n:=\{e_{1,2},e_{1,3},\dots,e_{1,n},e_{2,3},\dots,e_{2,n},\dots,e_{n-1,n}\}$. One easily checks that rank$L_n$=$|\mathcal{B}_n|=\binom{n}{2}$, which is the number of elements above the main diagonal for every $n\in\mathbb{N}$. Obviously, the same goes also for the extensions of $L_n$, namely $L_{n,p}$ and $\mathcal{L}_{n,p}$. And so, we have reached the target of our research, which is studying the $\hat{\zeta_{L,p}}$-function on the $\mathbb{Z}_p$-Lie algebra associated with $\mathcal{U}_n(\mathbb{Z}_p)$.
\subsection{Research goals}
As stated above, this research will focus on studying $\mathcal{U}_n(\mathbb{Z}_p)$ and its associated $\mathbb{Z}_p$-Lie algebra, namely $L_{n,p}$. The project consists of three major steps:\par
1. \textbf{Calculating the automorphism group of the $\mathbb{Q}_p$-Lie algebras $\mathcal{L}_{n,p}$, for all $n\in\mathbb{N}$ and all primes $p$.}\par
2. \textbf{Showing that the pro-isomorphic zeta-functions $\hat{\zeta_{L_{n,p}}}(s)$ are uniform for all $n\in\mathbb{N}$.}\par
3. \textbf{Giving an explicit uniform formula for the zeta-functions $\hat{\zeta_{L_{n,p}}}(s)$ for specific values of $n$, if not for all $n\in\mathbb{N}$.}\par
As we elaborate further, steps 1 and 2 are already known entirely for $n\leq 5$, and step 3 is known for $n\leq 4$.
We start with the first step of calculating $Aut_{\mathbb{Q}_p}(\mathcal{L}_{n,p})$. These automorphism groups have been studied for decades from a different point of view.  There are classical results showing that any automorphism may be expressed as a product of automorphisms of a specific type; see, for instance, the main result of Gibbs \cite{Gibbs}.  These results are not explicit enough for our purposes; indeed, the submonoid $G^+(\mathbb{Q}_p)$ arises, for us, as the domain of integration of a $p$-adic integral.  In order to compute this integral, we need to decompose the automorphism group $G(\mathbb{Q}_p)$ into a repeated semi-direct product of groups with a simple structure.
\par
After we have analyzed the structure of $G(\mathbb{Z}_p)$, we will need to construct the monoid $G^+(\mathbb{Q}_p)$ and its $G(\mathbb{Z}_p)$ right-cosets, as we have seen above. This will give us both the function to integrate, which is $\det\varphi$ for every $G(\mathbb{Z}_p)$ right-coset $G(\mathbb{Z}_p)\varphi$, and the domain of integration, which is the monoid $G^+(\mathbb{Q}_p)$. We will use this information to analyze the behavior of the $p$-adic integral we have described above and prove that its calculation depends only on $p$, thus showing that the $\hat{\zeta_{L,p}}$-function is uniform.
\subsection{The Heisenberg group}
We show the very basic approach to this problem, by the simplest example, the \textbf{Heisenberg group}, which is simply $\mathcal{U}_3(\mathbb{Z})$, and its associated $\mathbb{Z}$-Lie algebra. However, this example is far from complying with the general case of $n>3$, as we shall see later, and we only use it to demonstrate the basic technique we shall be using. 
Since $\mathcal{U}_3(\mathbb{Z})$ is the group of unipotent $3\times 3$ matrices over $\mathbb{Z}$, we observe that the basis for the associated $\mathbb{Z}$-Lie algebra is $\mathcal{B}_3=\{e_{12},e_{13},e_{23}\}$. We also observe that for every $L_n$ we can apply a linear order to the basis $\mathcal{B}_n$, where $e_{ij}<e_{kl}$ if the difference $j-i$ is less than $l-k$, or if both differences are equal, and $i<k$. In other words, we apply an order that divides $\mathcal{B}_n$ to basis elements of $\sfrac{L_n}{\gamma_2},\sfrac{\gamma_2}{\gamma_3},\dots,\sfrac{\gamma_{n-2}}{\gamma_{n-1}},\gamma_{n-1}$. Therefore, we set the basis of $L_3$ according to this order, $\mathcal{B}_3=\{e_{12},e_{23},e_{13}\}$.
Every $\varphi\in G(\mathbb{Z})$ must obey the Lie brackets. This means that if we analyze $\varphi$ by its operation on the basis elements, then $\varphi$ must be some $3\times 3$ matrix over $\mathbb{Z}$, such that multiplying, from the right, with any vector $v=xe_{12}+ye_{23}+ze_{13}\in L_{n,p}$, yields a vector $u=x\varphi(e_{12})+y\varphi(e_{23})+z\varphi(e_{13})\in L_{n,p}$, such that $\varphi(u)=\varphi^2(v)=v$, i.e., \[\begin{pmatrix}
x & y & z\\
\end{pmatrix}\begin{pmatrix}
a_{11} & a_{12} & a_{13}\\
a_{21} & a_{22} & a_{23}\\
a_{31} & a_{32} & a_{33}\\
\end{pmatrix}=\begin{pmatrix}
\varphi(x) & \varphi(y) & \varphi(z)\\
\end{pmatrix}\]
then we observe that $a_{31}e_{12}+a_{32}e_{23}+a_{33}e_{13}=\varphi(e_{13})=\varphi[(e_{12}),(e_{23})]=[\varphi(e_{12}),\varphi(e_{23})]=[a_{11}e_{12}+a_{12}e_{23}+a_{13}e_{13},a_{21}e_{12}+a_{22}e_{23}+a_{23}e_{13}]=(a_{11}a_{22}-a_{12}a_{21})e_{13}$, which gives the following relations, $$
a_{31}=0$$
$$a_{32}=0$$
$$a_{33}=(a_{11}a_{22}-a_{12}a_{21})\neq 0
$$
which means that $\varphi$ is the following matrix, $\varphi=\begin{pmatrix}
a_{11} & a_{12} & a_{13}\\
a_{21} & a_{22} & a_{23}\\
0 & 0 & \det A\\
\end{pmatrix}
$
where $A=\begin{pmatrix}
a_{11} & a_{12}\\
a_{21} & a_{22}\\
\end{pmatrix}
$, and $A$ must be invertible, otherwise $\varphi$ is not bijective. Based on the construction from earlier, of $L_{n,p}$ and $\mathcal{L}_{n,p}$, all the above applies also for $G_n(\mathbb{Z}_p)$ and for $G_n(\mathbb{Q}_p)$, respectively.
\subsection{$\mathcal{U}_n(\mathbb{Z}_p)$ groups for $n>3$}
Mark N. Berman, in his doctoral thesis\cite{Berman}, has displayed an explicit formula for $\hat{\zeta_{L_{4,p}}}$, and proved that $\hat{\zeta_{L_{5,p}}}$ is, indeed, uniform. Here, $L_{4,p}$ and $L_{5,p}$ are the $\mathbb{Z}_p$-Lie algebras associated with the groups $\mathcal{U}_4(\mathbb{Z}_p)$ and $\mathcal{U}_5(\mathbb{Z}_p)$, respectively. We aim to generalize his work to all $\mathcal{U}_n(\mathbb{Z}_p)$ and its associated $\mathbb{Z}_p$-Lie algebra, that is, as stated earlier, to display the full computation of $G_n(\mathbb{Z}_p)$, to prove that $\hat{\zeta_{L_{n,p}}}$ is uniform, and to give, if possible, a full description of the $\hat{\zeta_{L_{n,p}}}$ formula, for every $n\in\mathbb{N}$. By analyzing carefully Berman's work on $L_{4,p}$ and $L_{5,p}$, we gain the basic understanding of the expected structure of the local zeta-functions in the general case.
We begin our discussion of the first goal, which is computing $G_n(\mathbb{Z}_p)$, by first recalling that for every $v\in L_{n,p}$, the $\mathbb{Z}_p$-Lie algebra associated with $\mathcal{U}_n(\mathbb{Z}_p)$ where $n\geq3$, we present $\varphi(v)$ as the multiplication of $v$ by a matrix from the right $\varphi(v)=vM$. As stated earlier, $M$ is an $r\times r$ matrix, where $r$=rank$L_{n,p}=\binom{n}{2}$, whose lines are set by the order we have defined above, i.e., considering the standard basis \[\mathcal{B}_n=\{e_{
12},e_{23},\dots,e_{n-1,n},e_{13},\dots,e_{n-1.n},\dots,e_{1n}\}\] then $M$ is the following matrix,
$$
M=\begin{pmatrix}
\varphi(e_{12})\\
\varphi(e_{23})\\
\varphi(e_{n-1,n})\\
\hdashline
\varphi(e_{13})\\
\vdots\\
\varphi(e_{n-2,n})\\
\hdashline
\vdots\\
\hdashline
\varphi(e_{1n})\\
\end{pmatrix}\\
$$
Given an $\mathcal{L}_{n,p}$-automorphism $\varphi$, we denote by $\varphi_i:\gamma_i\mathcal{L}_{n,p}\rightarrow\gamma_i\mathcal{L}_{n,p}$ the restriction of $\varphi$ to the $i$th element of the lower central series, that is, for every basis element $e_{k,k+i}$, where $1\leq k\leq n-i$, we take, from the linear combination which forms the image $\varphi(e_{k,k+i})=\lambda_{12}e_{12}+\lambda_{23}e_{23}+\cdots+\lambda_{1n}e_{1n}$, only the partial linear combination $\varphi_i(e_{k,k+i})=\lambda_{1,1+i}e_{1,1+i}+\lambda_{2,2+i}e_{2,2+i}+\cdots+\lambda_{1n}e_{1n}$ of basis elements in $\gamma_i\mathcal{L}_{n,p}$. We shall see later that the restriction of the codomain to the subalgebra $\gamma_i\mathcal{L}_{n,p}$ is naturally derived from the restriction of the domain. For every $\varphi_i$ and $\varphi_{i+1}$, we have the induced map, denoted by $\varphi_{i,i+1}$, from the quotient algebra $\sfrac{\gamma_i}{\gamma_{i+1}}$ to itself, defined by $\varphi_{i,i+1}(e_{k,k+i}):=\varphi_i(e_{k,k+i})+\varphi_{i+1}(\gamma_{i+1}\mathcal{L}_{n,p})$. Clearly, $\varphi_{i,i+1}$ is well-defined, since $\varphi_i(\gamma_i\mathcal{L}_{n,p})=\gamma_i\mathcal{L}_{n,p}$, for every $1\leq i\leq n-1$.
Following this division of $\mathcal{L}_{n,p}$ by the lower central series and its quotients, we view $M$ as a block matrix, $$M=\begin{pmatrix}
M_{11} & \vline & M_{12}&\vline & \dots& \vline & M_{1,n-2} & \vline&M_{1,n-1}\\
\hline
M_{21} & \vline & M_{22}&\vline & \dots &\vline & M_{2,n-2} &\vline& M_{2,n-1}\\
\hline
\vdots & \vline & \vdots&\vline & \ddots &\vline & \vdots &\vline& \vdots\\
\hline
M_{n-1,1} & \vline & M_{n-1,2}&\vline & \dots &\vline & M_{n-1,n-2} &\vline& M_{n-1,n-1}\\
\end{pmatrix}
$$
each block is denoted by $M_{ij}\in\mathcal{M}_{k\times l}(\mathbb{Q}_p)$, where $k$=dim$\sfrac{\gamma_i}{\gamma_{i+1}}$ and $l$=dim$\sfrac{\gamma_j}{\gamma_{j+1}}$. From this, we can understand that the blocks on the main diagonal of $M$, which are the induced quotient maps defined above, are square matrices $\varphi_{i,i+1}=M_{ii}\in\mathcal{M}_{n-i}(\mathbb{Q}_p)$. We present, in the preliminary results section, our very first conclusions regarding these blocks. Dividing $M$ into blocks is our main strategy for computing the general form of the $\mathcal{L}_{n,p}$-automorphisms, because, as we shall start showing in the preliminary results section, one block determines other blocks related to it.
A trivial result, as seen above in the computation on the Heisenberg group, is that any element $e_{i,i+k}\in\gamma_k L_p$ must vanish in the images of elements of higher nilpotency classes, that means, for every $l>k$, $\varphi(e_{i,i+l})=0e_{12}+0e_{23}+\cdots+0e_{n-1,n}+0e_{13}+\cdots+0e_{1,1+k}+\cdots+0e_{n-k,n}+\cdots+0e_{n-l+1,n}+\lambda_{1,1+l}e_{1,1+l}+\lambda_{2,2+l}e_{2,2+l}+\cdots+\lambda_{n-l,n}e_{n-l,n}+\cdots+\lambda_{1n}e_{1n}$, hence, we conclude that all the elements under every square block on the main diagonal must be zero, so $M$ has the form, $$M=\begin{pmatrix}
M_{11} & \vline & M_{12}&\vline & M_{13} & \dots& \vline & M_{1,n-2} & \vline&M_{1,n-1}\\
\hline
0 & \vline & M_{22}&\vline & M_{23} & \dots &\vline & M_{2,n-2} &\vline& M_{2,n-1}\\
\hline
\vdots & \vline & \vdots&\vline & \vdots & \ddots &\vline & \vdots &\vline& \vdots\\
\hline
0 & \vline & 0&\vline & 0 & \dots &\vline & M_{2,n-2} &\vline& M_{2,n-1}\\
\hline
0 & \vline & 0 &\vline & 0 & \dots &\vline & 0 &\vline& M_{n-1,n-1}\\
\end{pmatrix}
$$
One easily checks that $\varphi_{ij}:\sfrac{\gamma_i}{\gamma_j}\rightarrow\sfrac{\gamma_i}{\gamma_j}$, where $1\leq i<j\leq n-1$, is the sequence of blocks \[
\begin{matrix}
M_{ii},M_{i,i+1},\dots,M_{i,j-1},M_{i+1,i},M_{i+1,i+1},\dots,M_{i+1,j-1},\dots,M_{j-1,i},M_{j-1,i+1}\dots,\\M_{j-1,j-1}
\end{matrix}
\]
which forms an extended square block in $M$. These extended blocks shall become handy, for computing elements of $M$ that lie further away from the main diagonal.
\subsection{Preliminary results}
\label{preliminary.results}
A major step towards the computation of $G_n(\mathbb{Q}_p)$ would be to observe some invariants of $\mathcal{L}_{n,p}$, which must be preserved under any $\mathcal{L}_{n,p}$-automorphism $\varphi\in G_n(\mathbb{Q}_p)$, and analyze the constraints on the structure of the $\mathcal{L}_{n,p}$-automorphisms that come out of this observation. We shall start by examining dimensions of centralizers of basis elements relative to subalgebras of $\mathcal{L}_{n,p}$ and their quotients. As we saw earlier, dividing the matrix $M$ to blocks means that we can restrict both the domain and codomain of $\varphi$ by nilpotency classes and their quotients. Starting from the very first block $M_{11}$, which is the restriction $\varphi_{12}:\sfrac{\gamma_1}{\gamma_2}\rightarrow\sfrac{\gamma_1}{\gamma_2}$, we observe that the first basis element $e_{12}$ has only one other basis element in the quotient $\sfrac{\gamma_1}{\gamma_3}$ which does not commute with it, namely $e_{23}$; and although $e_{24}\in\sfrac{\gamma_1}{\gamma_3}$, it does not commute with $e_{12}$, because $[e_{12},e_{24}]=e_{14}\in\gamma_3\mathcal{L}_{n,p}$, hence it vanishes in the quotient $\sfrac{\gamma_1}{\gamma_3}$.
Therefore, the centralizer of $e_{12}$ in $\sfrac{\gamma_1}{\gamma_3}$ is $\mathcal{C}_{13}(e_{12})=\mathcal{C}_{\sfrac{\gamma_1}{\gamma_3}}(e_{12})=\{e_{12},e_{34},\dots,e_{n-1,n}\}$, which means that dim$\sfrac{\sfrac{\gamma_1}{\gamma_2}}{\mathcal{C}_{13}(e_{12})}=$dim$\{e_{23}\}=1$. The image $\varphi_{12}(e_{12})=\lambda_1 e_{12}+\cdots+\lambda_{n-1}$, being in bijection with $e_{12}$, respects any algebraic structure induced by it, and therefore, dim$\sfrac{\sfrac{\gamma_1}{\gamma_2}}{\mathcal{C}_{13}(\varphi_{12}(e_{12}))}=1$ as well. This means that the image $\varphi_{12}(e_{12})$ must have only one element in $\varphi_{12}(\sfrac{\gamma_1}{\gamma_2})$ that does not commute with it. The only elements in $\sfrac{\gamma_1}{\gamma_2}$ which commute with all the elements in the quotient except for one are $e_{12}$ and $e_{n-1,n}$, one checks, although not without some effort, that the image $\varphi_{12}(e_{12})$ can only have one of these two elements, and no other element, hence, the first row of the first block $M_{11}$ is either $\begin{pmatrix}
\lambda_1 & 0 & \dots & 0
\end{pmatrix}$ or $\begin{pmatrix}
0 & \dots & 0 & \lambda_{n-1}
\end{pmatrix}$, for some $\lambda_1,\lambda_{n-1}\in\mathbb{Q}_p$, but this means that the last row of the block, which forms the image $\varphi_{12}(e_{n-1,n})$ is either $\begin{pmatrix}
0 & \dots & 0 & \lambda_{n-1}
\end{pmatrix}$ or $\begin{pmatrix}
\lambda_1 & 0 & \dots & 0
\end{pmatrix}$, respectively. Without loss of generality, assume that $\varphi_{12}(e_{12})=\lambda_1 e_{12}$ and $\varphi_{12}(e_{n-1,n})=\lambda_{n-1}e_{n-1,n}$, and observe every $\varphi_{12}(e_{i,i+1})$, where $3\leq i\leq n-1$, which commutes with $\varphi_{12}(e_{12})$. So, if $\varphi_{12}(e_{i,i+1})=a_{12}^i e_{12}+a_{23}^i e_{23}+\cdots+a_{n-1,n}^i e_{n-1,n}$, where $a_{12}^i,a_{23}^i,\dots,a_{n-1,n}^i\in\mathbb{Q}_p$, then $[\varphi_{12}(e_{12}),\varphi_{12}(e_{i,i+1})]=[\lambda_1 e_{12},a_{12}^i e_{12}+\cdots+a_{n-1,n}^i e_{n-1,n}]=\lambda_1 a_{23}^i e_{13}=0$, but $\lambda_1\neq 0$, hence $a_{23}^i$ must vanish, which means that the block $M_{11}$ has $0$ in column $2$ for every row $3\leq i\leq n-1$. Do the same for all the elements that commute with $\varphi_{12}(e_{n-1,n})$, namely $\varphi_{12}(e_{12}),\varphi_{12}(e_{23}),\dots,\varphi_{12}(e_{n-3,n-2})$, to obtain that $M_{11}$ has $0$ in column $n-1$ for every row $1\leq i\leq n-3$. On the other hand, take $\varphi_{12}(e_{12})$ and $\varphi_{12}(e_{23})$ which do not commute, that is, $[\varphi_{12}(e_{12}),\varphi_{12}(e_{23})]=[\lambda_1 e_{12},a_{12}^2 e_{12}+\cdots+a_{n-1,n}^2 e_{n-1,n}]=\lambda_1 a_{23}^2 e_{13}\neq 0$, which means that $a_{23}^2\neq 0$, hence $M_{11}$ has a non-vanishing value $a_{23}^2$, which we denote by $\lambda_2$, in row $2$ column $2$. Same applies to the image $\varphi_{12}(e_{n-2,n-1})$, and so we obtain $\lambda_{n-2}$ in row $n-2$ column $n-2$. Continue this construction, from the edges of $M_{11}$ and further to the inside, to obtain that for every $n\geq 4$, the block $M_{11}$ is either diagonal or anti-diagonal, i.e., one of the following two forms: \[M'_{11}=\begin{pmatrix}
\lambda_1 & & &\\
& \lambda_2 & &\\
& & \ddots &\\
& & & \lambda_{n-1}\\
\end{pmatrix},M''_{11}=\begin{pmatrix}
& & & \lambda_1\\
& & \lambda_2 &\\
& \iddots & &\\
\lambda_{n-1} & & &\\
\end{pmatrix}\]
Therefore, if we obtain, through our computation, that $M_{11}=M'_{11}$, then we say that $M_{11}$ is diagonal, but in the case of the anti-diagonal block $M''_{11}$, we have the following proposition,
\begin{proposition}
\label{prop.involution}
Let $\mathcal{L}_{n,p}$ be the $\mathbb{Q}$-Lie algebra associated with $\mathcal{U}_n(\mathbb{Z}_p)$, and let $\mathcal{B}_n=\{e_{12},e_{23},\dots,e_{1n}\}$ be its basis. Then, the map $\eta_n:\mathcal{B}_n\rightarrow \mathcal{B}_n$, defined by \[\eta_n(e_{ij}):=(-1)^{j-i-1}e_{n+1-j,n+1-i}\] is an involution, hence, also an $\mathcal{L}_{n,p}$-automorphism.
\end{proposition}
\begin{proof}
Clearly, we calculate $\eta_n^2(e_{ij})$ by taking $k=n+1-j$ and $l=n+1-i$. Hence, \[\eta_n(\eta_n(e_{ij}))=\eta_n((-1)^{j-i-1}e_{kl})=(-1)^{j-i-1}\eta_n(e_{ij})=(-1)^{j-i-1}(-1)^{l-k-1}e_{n+1-l,n+1-k}=\]\[=(-1)^{j-i-1}(-1)^{n+1-i-(n+1-j)-1}e_{n+1-(n+1-i),n+1-(n+1-j)}=(-1)^{j-i-1}(-1)^{j-i-1}e_{ij}=\]\[=e_{ij}\]
To complete the proof, we need to show that $\eta_n$ is, indeed, a homomorphism,
\[[\eta_n(e_{ij}),\eta_n(e_{jk})]=[(-1)^{j-i-1}e_{n+1-j,n+1-i},(-1)^{k-j-1}e_{n+1-k,n+1-j}]=\]\[=(-1)^{j-i-1}(-1)^{k-j-1}[e_{n+1-j,n+1-i},e_{n+1-k,n+1-j}]=(-1)^{j-i-1+k-j-1}(-e_{n+1-k,n+1-i})=\]\[=(-1)^{k-i-2}(-1)e_{n+1-k,n+1-i}=(-1)^{k-i-1}e_{n+1-k,n+1-i}=\eta_n(e_{ik})=\eta_n([e_{i,j},e_{j,k}])\]
\end{proof}
From this proposition, we get that if $M_{11}=M''_{11}$, we can turn $\varphi$ to be $\eta_n\varphi$, thus changing $M_{11}$ to the restriction of $\eta_n$ on $M''_{11}$, which becomes a diagonal block. Therefore, without loss of generality, we can say that $M_{11}$ is always diagonal. The importance of this fact is well explained in the following proposition,
\begin{proposition}
\label{prop.main.diagonal.blocks}
Let $\mathcal{L}_{n,p}$ be the $\mathbb{Q}$-Lie algebra associated with $\mathcal{U}_n(\mathbb{Z}_p)$, and let $\varphi\in G_n(\mathbb{Q}_p)$ be an $\mathcal{L}_{n,p}$-automorphism. Then, all the blocks on the main diagonal, $M_{ii},\dots,M_{n-1,n-1}$, are diagonal blocks, which means that $M$ itself is of the form,$$
M=\begin{pmatrix}
\lambda_1 & 0 & \dots & 0 & * & * & \dots & *& \dots & *\\
0 & \lambda_2 & \vdots & \vdots & * & * & \vdots & * & \dots & *\\
\vdots & \dots & \ddots & 0 & \vdots & \dots & \ddots & \vdots & \dots & *\\
0 & \dots & 0 & \lambda_{n-1} & * & * & \dots & * & \dots & *\\
& & & & \lambda_1\lambda_2 & 0 & \dots & 0 & \dots & *\\
& & & & 0 & \lambda_2\lambda_3 & \dots & \vdots & \dots & *\\
& & & & \vdots & \dots & \ddots & 0 & \dots & \vdots\\
& & & & 0 & \dots & 0 & \lambda_{n-2}\lambda_{n-1} & \dots & *\\
& & & & & & & & \ddots &\\
& & & & & & & & & \lambda_1\lambda_2\cdots\lambda_{n-1}\\
\end{pmatrix}
$$
where $\lambda_1,\lambda_2,\dots,\lambda_{n-1}\in\mathbb{Q}_p$.
\end{proposition}
\begin{proof}
By induction. Given some $1<i\leq n-1$, we assume this is true for all $M_{kk}$, where $k<i$. We take $i=2$, and indeed, we already know that $M_{11}$ is diagonal of the described form. Every block $M_{ii}$ represents the coefficients of elements in the quotient algebra $\sfrac{\gamma_i L_{n,p}}{\gamma_{i+1} L_{n,p}}$ in the linear combinations that form the images of elements of that algebra. We said earlier that the coefficients of any element in $\sfrac{L_{n,p}}{\gamma_i L_{n,p}}$ vanish in the images of elements in $\gamma_i L_{n,p}$, so for every $e_{kl}\in\sfrac{\gamma_i L_{n,p}}{\gamma_{i+1} L_{n,p}}$, the image of $e_{kl}$ is of the form, $\varphi(e_{kl})=0(e_{12}+e_{23}+\dots+e_{n-1,n}+e_{13}+\dots+e_{n-2,n}+\dots+e_{1,i}+e_{2,i+1}+\dots+e_{n-i+1,n})+a_{1,1+i}e_{1,1+i}+a_{2,2+i}e_{2,2+i}+\dots+a_{n-i,n}e_{n-i,n}+\gamma_{i+1}L_{n,p}$, where $a_{1,1+i},a_{2,2+i},\dots,a_{n-i,n}$. As seen earlier, every $\mathbb{Z}_p$-automorphism respects the Lie brackets, so, taking the first element in $\gamma_i L_{n,p}$, namely $e_{1,1+i}$, we observe that $\varphi(e_{1,1+i})=\varphi([e_{1,i},e_{i,i+1}])=[\varphi(e_{1,i}),\varphi(e_{i,i+1})])$. The blocks that represent the domains and images of $e_{1,i}$ and $e_{i,i+1}$ are $M_{i-1,i-1}$ and $M_{1,1}$, respectively, which are diagonal of the form described above, by the assumption, which means that $\varphi(e_{1,1+i})=[\varphi(e_{1,i}),\varphi(e_{i,i+1})]=[a_{1,i}e_{1,i}+\gamma_i L_{n,p},a_{i,i+1}e_{i,1+i}+\gamma_2 L_{n,p}]=a_{1,i}a_{i,1+i}e_{1,i+1}+\gamma_{i+2} L_{n,p}$, which proves that there is one and only one nonzero coefficient of an element in $\gamma_i L_{n,p}$, in the image of $e_{1,1+i}$, and this coefficient is the scalar that multiplies $e_{1,1+i}$ itself, meaning that in the first row of the block $M_{ii}=(m_{kl}^{ii})$, only the first cell $m_{11}^{ii}=a_{1,i}a_{i,1+i}$ is nonzero, and all the other cells are zero, $m_{1,2}^{ii}=m_{1,3}^{ii}=\dots =m_{1,n-i}^{ii}=0$. We replace the coefficient $a_{i,1+1}$ with $\lambda_i$, and so we have $a_{1,i}\lambda_i$ as the coefficient of $e_{1,1+i}$ in the image $\varphi(e_{1,1+i})$. Now We decompose $\varphi(e_{1,i})$ itself to the Lie brackets of the images $[\varphi(1,i-1),\varphi(i-1,i)]$, and by the same induction assumption, we get that $\varphi(e_{1,i})=a_{1,i-1}a_{i-1,i}e_{1,i}=a_{1,i-1}\lambda_{i-1}e_{1,i}$, therefore, the image $\varphi(e_{1,1+i)}=a_{1,i-1}\lambda_{i-1}\lambda_i e_{1,1+i}$, continue this until we have only factors in $\sfrac{\mathcal{L}_{n,p}}{\gamma_2}$ as the coefficients of $e_{1,1+i}$ in the image $\varphi(e_{1,1+i})$, and so we get that $\varphi(e_{1,1+i})=\lambda_1\lambda_2\dots\lambda_{i}e_{1,1+i}$. Doing the same with $\varphi(e_{2,2+i}),\varphi_{3,3+i},\dots,\varphi(e_{n-i,n})$, are of the form $\lambda_2\lambda_3\dots\lambda_{i+1}e_{2,2+i},\lambda_3\lambda_4\dots\lambda_{i+2}e_{3,3+i},\dots,\lambda_n-i\lambda_n-i+1\dots\lambda_n e_{n-i,n}$, respectively, which completes the proof.
\end{proof}
This means that every $M=\varphi\in\mathcal{L}_{n,p}$ has the form,$$M=\begin{pmatrix}
\begin{matrix}\lambda_1 & & &\\
& \lambda_2 & &\\
& & \ddots &\\
& & & \lambda_{n-1}\\
\end{matrix} & \vline & M_{12}&\vline & \dots& \vline & M_{1,n-2} & \vline&M_{1,n-1}\\
\hline
0 & \vline & \begin{matrix}\lambda_1\lambda_2 & & &\\
& \lambda_2\lambda_3 & &\\
& & \ddots &\\
& & & \lambda_{n-2}\lambda_{n-1}\\
\end{matrix}&\vline & \dots &\vline & M_{2,n-2} &\vline& M_{2,n-1}\\
\hline
\vdots & \vline & \vdots&\vline & \dots &\vline & \vdots &\vline& \vdots\\
\hline
0 & \vline & 0&\vline & \dots &\vline & \ddots &\vline& M_{n-2,n-1}\\
\hline
0 & \vline & 0 &\vline & \dots &\vline & 0 &\vline& \lambda_1\lambda_2\cdots\lambda_{n-1}\\
\end{pmatrix}$$
Before we continue with some conclusions from this highly important observation, we need to go back to the Heisenberg group, where $n=3$, and explain why it does not follow this rule, as found for the groups where $n>3$. As seen earlier, $\mathcal{U}_n(\mathbb{Z}_p)$ is of nilpotency class $2$, so instead of observing the quotient $\sfrac{\gamma_1}{\gamma_3}$, we consider centralizers on $\mathcal{L}_{3,p}$ itself. We have the symmetry $\mathcal{C}_{\mathcal{L}_{3,p}}(e_{12})=\{e_{12},e_{13}\}$ and $\mathcal{C}_{\mathcal{L}_{3,p}}(e_{23})=\{e_{23},e_{13}\}$, which means that $\sfrac{\mathcal{L}_{3,p}}{\mathcal{C}_{\mathcal{L}_{3,p}}(e_{12})}=\{e_{23}\}$ and $\sfrac{\mathcal{L}_{3,p}}{\mathcal{C}_{\mathcal{L}_{3,p}}(e_{23})}=\{e_{12}\}$, which obviously applies also for the images $\varphi(e_{12})$ and $\varphi(e_{23})$. This means that the centralizers on the images are determined only by the basis elements and not by their coefficients in $\varphi$. For better understanding, if $\varphi(e_{12})=a_{12}e_{12}+a_{23}e_{23}+a_{13}e_{13}$ and $\varphi(e_{23})=b_{12}e_{12}+b_{23}e_{23}+b_{13}e_{13}$ and $\varphi(e_{13})=c_{12}e_{12}+c_{23}e_{23}+c_{13}e_{13}$, then $[\varphi(e_{12}),\varphi(e_{23})]=(a_{12}b_{23}-a_{23}b_{12})e_{13}=\varphi(e_{13})=c_{13}e_{13}$ This means that there is no constraint on any of the coefficients of $\varphi(e_{12})$ and $\varphi(e_{23})$, because any choice of $a_{12},a_{23},a_{13},b_{12},b_{23},b_{13}$ is allowed, as long as $a_{12}b_{23}-a_{23}b_{12}\neq 0$.
The above discussion gives rise to the basic strategy of decomposing each automorphism $\varphi\in G(\mathbb{Q}_p)$ into two automoprhisms, one is represented by the diagonal matrix\[H=\begin{pmatrix}
\begin{matrix}\lambda_1 & & &\\
& \lambda_2 & &\\
& & \ddots &\\
& & & \lambda_{n-1}\\
\end{matrix} & \vline & &\vline &  &  & \vline&\\
\hline
 & \vline & \begin{matrix}\lambda_1\lambda_2 & & &\\
& \lambda_2\lambda_3 & &\\
& & \ddots &\\
& & & \lambda_{n-2}\lambda_{n-1}\\
\end{matrix}&\vline &  & &\vline& \\
\hline
 & \vline & &\vline &  & \ddots &\vline& \\
\hline
 & \vline &  &\vline &  &  &\vline& \lambda_1\lambda_2\cdots\lambda_{n-1}\\
\end{pmatrix}
\]
and the other is represented by a unipotent matrix of the form, \[N=\begin{pmatrix}
1 &0 &\dots &0 &\vline &* &\dots &* &\vline& *\\
0& 1 &\vdots &0 &\vline&* &\dots &* &\vline&*\\
\vdots& \dots& \ddots & 0&\vline& *& \dots& *&\vline & *\\
0& \dots& 0& 1&\vline & * & \dots & * &\vline & *\\
\hline
0&\dots &0 & 0& \vline &1&\dots &0&\vline&*\\
0&\dots &0 & 0& \vline & 0 & 1 & 0 &\vline &*\\
0&\dots &0 & 0& \vline & 0 & \dots & 1 &\vline &*\\
\hline
0&\dots &0 & 0& \vline & 0 & 0 & 0 &\vline &1\\
\end{pmatrix}
\]
where the main diagonal blocks of $N$ are $I_{n-1},I_{n-2},\dots,I_1$. It is readily seen that the decomposition $\varphi=NH$ is unique, since $H$ has the main diagonal of $\varphi$, and as both matrices are invertible, $N$ is uniquely determined by $H$, since $N=\varphi H^{-1}$.
This observation gives the following set of propositions, one easily checks that all of them are correct,
\begin{proposition}
\label{prop.automorphism.subgroup.h}
Let $\mathcal{H}=H_n(\mathbb{Q}_p)$ be the set of all matrices of the form of $H$, then $\mathcal{H}$ is an abelian subgroup which forms the \textbf{reductive} part of $G_n(\mathbb{Q}_p)$
\end{proposition}
\begin{proposition}
\label{prop.automorphism.subgroup.n}
Let $\mathcal{N}=N_n(\mathbb{Q}_p)$ be the set of all matrices of the form of $N$, then $\mathcal{N}$ is a normal subgroup which forms the \textbf{unipotent radical} of $G_n(\mathbb{Q}_p)$
\end{proposition}
\begin{proposition}
\label{prop.automorphism.matrix.decomposition}
Let $\varphi\in G(\mathbb{Q}_p)$ be an $\mathcal{L}_{n,p}$-automorphism, and let $M$ be the coefficient matrix of $\varphi$, then, $M$ has a unique decomposition $M=NH$, where $H$ and $N$ are as described above.
\end{proposition}
It is readily seen that $\mathcal{H}$ is not a normal subgroup. In addition, $\mathcal{H}\cup \mathcal{N}=G_n(\mathbb{Q}_p)$, as a union of sets , and $\mathcal{H}\cap \mathcal{N}=\{I_m\}$, thus we have the following important result,
\begin{corollary}
Let $G_n(\mathbb{Q}_p)$ be the group of $\mathcal{L}_{n,p}$-automorphisms, and let $\phi:\mathcal{H}\rightarrow Aut(\mathcal{N})$ be the homomorphism defined by $\phi(H)(N):=HNH^{-1}$, for every $H\in \mathcal{H}$ and every $N\in \mathcal{N}$. Then, $G_n(\mathbb{Q}_p)=\mathcal{N}\rtimes_{\phi}\mathcal{H}$, in words, $G_n(\mathbb{Q}_p)$ decomposes into an inner semidirect product of $\mathcal{N}$ and $\mathcal{H}$, induced by conjugation.
\end{corollary}
This corollary is highly important for our research because it enables us to simplify the domain of integration, for the $p$-adic integral that we aim to calculate. As we saw earlier, the calculation of $\hat{\zeta_{L_{n,p}}}$ requires computing $G_n(\mathbb{Z}_p)$ and $G_n^+(\mathbb{Q}_p)$ first. Assuming we have already computed $G_n(\mathbb{Q}_p)$, based on the strategy that we have presented above, we need to identify $G_n(\mathbb{Z}_p)$ as a subgroup of $G_n(\mathbb{Q}_p)$, which is supposed to be quite immediate, and continue from there to identify $G_n^+(\mathbb{Q}_p)$, which is expected to be more complicated. After computing $G_n(\mathbb{Z}_p)$, it is readily seen that the same decomposition of $G_n(\mathbb{Q}_p)$ into an inner semidirect product holds for $G_n(\mathbb{Z}_p)$ as well, so, denoting $\mathcal{N}=N_n(\mathbb{Z}_p)$ and $\mathcal{H}=H_n(\mathbb{Z}_p)$, where $N_n(\mathbb{Z}_p)$ and $H_n(\mathbb{Z}_p)$ are the reductive part and the unipotent radical of $G_n(\mathbb{Z}_p)$, respectively, we have that $G_n(\mathbb{Z}_p)=\mathcal{N}\rtimes_{\phi}\mathcal{H}$. We can use the identity found above, and observe that $\displaystyle\int_{G_n(\mathbb{Z}_p)\varphi}|\det\varphi|_p^sd\mu=\displaystyle\int_{(\mathcal{N}\rtimes_{\phi}\mathcal{H})\varphi}|\det\varphi|_p^sd\mu$.\par
By applying \textbf{Fubini's theorem} for measure spaces, we have that \[\displaystyle\int_{G_n(\mathbb{Z}_p)\varphi}|\det\varphi|_p^sd\mu_{G_n(\mathbb{Z}_p)\varphi}=\displaystyle\int_{\mathcal{N}}\left(\displaystyle\int_{\mathcal{H}}|\det\varphi|_p^sd\mu_{\mathcal{H}}\right)d\mu_{\mathcal{N}}\]
The advantage that we gain by this decomposition is that it simplifies the calculation of the integrand. Since the integrated function is $|\det\varphi|_p^s$, then decomposing $\varphi$ into the two automorphisms makes the calculation of their determinant much simpler. For the unipotent matrix $N$, the determinant is $1$, for the digonal matrix $H$, we have the following proposition,
\begin{proposition}
\label{prop.h.matrix.determinant}
Let $n=2,3,4,\dots$, and let $A_n$ 
be the diagonal $m\times m$ matrix where $m=\binom{n}{2}$, of the form of $H$ from above for $n-1$ scalars, then $\det A_n=\prod_{i=1}^{n}\lambda_i^{i(n+1-i)}$.
\end{proposition}
\begin{proof}
We observe that the determinants, for $n=2,3,4,\dots$, form a recursive sequence,
$$a_2=\det A_2=\lambda_1$$
$$a_3=\det A_3=\det A_2\lambda_1\lambda_2^2=\lambda_1^2\lambda2^2$$
$$a_4=\det A_4=\det A_3\lambda_1\lambda_2^2\lambda_3^3=\lambda_1^3\lambda_2^4\lambda_3^3$$
$$\vdots$$
$$a_n=\det A_n=\det A_{n-1}\lambda_1\lambda_2^2\lambda_3^3\cdots\lambda_{n-1}^{n-1}$$
Calculating the general element, $a_n=\det A_n$, we see that we have $n$ times $\lambda_1$, $n-1$ times $\lambda_2^2$, $n-2$ times $\lambda_3^3$, and so forth. In general, we have $n-i+1$ times $\lambda_i^i$, which means that we have $i(n-i+1)$ times $\lambda_i$, and in total, $a_n=\det A_n=\prod_{i=1}^n\lambda_i^{i(n+1-i)}$.
\end{proof}
We conclude this section with the observation that since we got a decomposition of the integration domain into two subgroups, $\mathcal{H}$ and $\mathcal{N}$, where $\mathcal{N}$ is significantly more complicated than $\mathcal{H}$, we should strive to decompose $\mathcal{N}$ itself into a product of finitely many simpler subgroups, $\mathcal{N}=\mathcal{N}_1\rtimes_{\phi}\mathcal{N}_2\rtimes_{\phi}\cdots\rtimes_{\phi}\mathcal{N}_{m_n}$, where $m_n$ is the number of subgroups in the decomposition of $\mathcal{N}$, for every $n\in\mathbb{N}$, which means that $\displaystyle\int_{G_n(\mathbb{Z}_p)\varphi}|\det\varphi|_p^sd\mu_{G_n(\mathbb{Z}_p)\varphi}=\displaystyle\int_{\mathcal{N}_{m_n}}\left(\cdots\displaystyle\int_{\mathcal{N}_3}\left(\displaystyle\int_{\mathcal{N}_2}\left(\displaystyle\int_{\mathcal{N}_1}\left(\displaystyle\int_{\mathcal{H}}|\det\varphi|_p^sd\mu_{\mathcal{H}}\right)d\mu_{\mathcal{N}_1}\right)d\mu_{\mathcal{N}_2}\right)d\mu_{\mathcal{N}_3}\cdots\right)d\mu_{\mathcal{N}_{m_n}}$. All the subgroups in the decomposition of $\mathcal{N}$ are obviously unipotent as well, which means that their determinants are also $1$. This means that the integrals on these subgroups depend only on the structure of the subgroups, which forms the integration domain for each integral in the decomposition.
\subsection{Base Extension}
Let $K$ be a number field of degree $d=[K:\mathbb{Q}]$, and let $\mathcal{O}_K$ be its ring of integers. Let $L$ be a $\mathbb{Z}$-Lie algebra of rank $r$. By base extension we can consider $L\otimes_{\mathbb{Z}}\mathcal{O}_K$ as a $\mathbb{Z}$-Lie algebra of rank $rd$, and by scalar extension we can consider also $L_{K,p}=(L\otimes_{\mathbb{Z}}\mathcal{O}_K)\otimes_{\mathbb{Z}}\mathbb{Q}_p$ as a $\mathbb{Z}$-Lie algebra of the same rank. Berman-Glazer-Schein\cite{BermanGlazerSchein} give a criterion under which the pro-isomorphic zeta-function of $L_{K,p}$, not necessarily for all $p$, can be calculated without a significant effort relative to that of $L$ itself. We shall research $L_{K,n,p}=L_n\otimes_{\mathbb{Z}}\mathcal{O}_K$, the tensor product of the $\mathbb{Z}$-Lie algebras associated with the groups $\mathcal{U}_n(\mathbb{Z})$ and an integer ring $\mathcal{O}_K$, and check whether the same criterion can be applied also to this tensor product, again, not necessarily for all $p$, thus allowing the calculation of $\hat\zeta_{L_{n,p}\otimes_{\mathbb{Z}}\mathcal{O}_K}(s)$, or at least allowing us to prove that the zeta-function of this tensor product is uniform.
\begin{thebibliography}{2}
\bibitem{Berman} Mark. N. Berman,
Proisomorphic zeta functions of groups
, Ph.D. thesis, University of Oxford,
2005.
\bibitem{BermanGlazerSchein}, Mark N. Berman, Itay Glazer, and Michael M. Schein, Pro-isomorphic zeta functions of nilpotent groups and lie rings under base extension, Transactions of the American Mathematical Society Volume 375, Number 2, February 2022, pages 1051–1100.
\bibitem{DuSautoyLubotzky} M.P.F. du Sautoy and A. Lubotzky, Functional equations and uniformity for
local zeta functions of nilpotent groups, Amer. J. Math. 118 (1996), no. 1, 39–
90.
\bibitem{Gibbs} John A. Gibbs, Automorphisms of certain unipotent groups, J. Algebra 14 (1970), 203-228.
\bibitem{GrunewaldSegalSmith} F. J. Grunewald, D. Segal, and G. C. Smith, Subgroups of finite index in nilpotent groups,
Invent. Math. 93 (1988), no. 1, 185–223, DOI 10.1007/BF01393692. MR943928.
\bibitem{LubotzkyMannSegal} Alexander Lubotzky, Avinoam Mann, and Dan Segal,
Finitely generated groups of polynomial
subgroup growth
, Israel J. Math.
82
(1993), no. 1-3, 363–371, DOI 10.1007/BF02808118.
MR1239055
\bibitem{MontgomeryVaughan} Hugh L. Montgomery and Robert C. Vaughan, Multiplicative Number Theory I. Classical Theory, Cambridge Studies in Advanced Mathematics 97, chapter 5.
\end{thebibliography}
\end{document}